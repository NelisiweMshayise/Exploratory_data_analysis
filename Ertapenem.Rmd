---
title: "Ertapenem_EDA"
output: html_document
date: "2025-07-20"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

 

# Load the packages

```{r}
library(tidyverse)
library(dplyr)
```

# Import the dataset

```{r}
Erta_EDA_Data <- read_excel("Erta_EDA Data.xlsx")
```

## Select the essential variables

```{r}
### selecting the columns
EDA_data_NM <- Erta_EDA_Data %>% 
                filter(!is.na(TIME), !is.na(ERTAPENEM)) %>% 
                  select(Pid, TIME, ERTAPENEM)
                

### Drawing the line graph

EDA_data_NM %>% 
  ggplot(aes(x= TIME, y= ERTAPENEM, color= factor(Pid), group= Pid))+
    geom_line() +
      labs(color= "Patient ID")+
        theme_minimal()

P <- EDA_data_NM %>%
  ggplot(aes(x = TIME, y = ERTAPENEM, color = factor(Pid), group = Pid)) +
  geom_line(size = 1) +                               # Line thickness
  geom_point(size = 2, shape = 14) +                  # Bullet points on the line
  labs(
    title = "Patient Plasma Concentration-Time profiles",
    x = "Time (hours)",
    y = "Ertapenem Concentration (µg/mL)",            # <-- Moved here
    color = "Patient ID"
  ) +
  theme_minimal() +
  theme(                                              # <-- Added missing +
    plot.title = element_text(hjust = 0.5, face = "bold", size = 14),
    axis.title = element_text(size = 12),
    legend.title = element_text(size = 11),
    legend.text = element_text(size = 10)
  )
ggsave("EDA_second_combined_line_graph.png", P, width = 8, height = 5)
```


```{r}

p <- EDA_data_NM %>%
  ggplot(aes(x = TIME, y = ERTAPENEM, color = factor(Pid), group = Pid)) +
  geom_line(size = 1) +                               # Line with unique color
  geom_point(size = 2, shape = 14)+                              # Bullet points
  facet_wrap(~ Pid, ncol = 1, scales = "free_y") +    # 3 separate graphs
  labs(
    title = "Ertapenem Concentration Over Time by Patient",
    x = "Time (hours)",
    y = "Ertapenem Concentration (µg/mL)",
    color = "Patient ID"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 14),
    strip.text = element_text(size = 12),              
    axis.title = element_text(size = 12),
    legend.position = "none")

ggsave("Individuals_EDA_line_graph_B.png", p, width = 8, height = 5)
```

